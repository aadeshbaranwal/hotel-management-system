{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\pc\\\\Desktop\\\\project\\\\oxotel-au3\\\\oxotel\\\\src\\\\components\\\\hotels\\\\Booking.js\";\nimport React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { bookRoom } from '../../api/api';\nexport default function Booking(props) {\n  // const type=props.state.hotel.type\n  console.log(\"booking props 1:\", props);\n  const [bookingDetails, udpateDetails] = useState({\n    checkIn: \"\",\n    checkOut: \"\",\n    adults: 0,\n    childs: 0,\n    totalDays: 0,\n    totalprice: 0,\n    showBooking: true,\n    dbooking: false,\n    showPayment: false,\n    bookingMsg: false,\n    username: \"\"\n  });\n  useEffect(() => {\n    // const type = props.state.hotel.type\n    udpateDetails({\n      checkIn: \"\",\n      checkOut: \"\",\n      adults: 0,\n      childs: 0,\n      totalDays: 0,\n      totalprice: 0,\n      showBooking: true,\n      dbooking: false,\n      showPayment: false,\n      bookingMsg: false,\n      username: JSON.parse(localStorage.getItem(\"signupData\")).username\n    });\n  }, []);\n  const username = JSON.parse(localStorage.getItem(\"signupData\")).username;\n  const bedRooms = props.state.hotel.bedRooms;\n  console.log(username, bedRooms);\n  console.log(\"inside booking props: \", bookingDetails);\n\n  const handleChange = event => {\n    console.log(event.target.value);\n    const {\n      name\n    } = event.target; // console.log(e.target.value)\n\n    udpateDetails({ ...bookingDetails,\n      [name]: event.target.value\n    });\n  };\n\n  const handleSubmit = event => {\n    console.log(bookingDetails.checkOut);\n    let totaldays = datediff(parseDate(bookingDetails.checkIn), parseDate(bookingDetails.checkOut));\n    udpateDetails({ ...bookingDetails,\n      totalDays: totaldays,\n      showBooking: false,\n      dbooking: true\n    });\n    event.preventDefault();\n  };\n\n  const parseDate = str => {\n    var mdy = str.split('-');\n    return new Date(mdy);\n  };\n\n  const datediff = (first, second) => {\n    return Math.round((second - first) / (1000 * 60 * 60 * 24));\n  };\n\n  const today = new Date();\n  const date = today.getFullYear() + '-' + ('0' + (today.getMonth() + 1)).slice(-2) + '-' + ('0' + today.getDate()).slice(-2);\n\n  const checkOutD = str => {\n    let DateStr = str.split('-');\n    DateStr[2] = Number(DateStr[2]) + 1;\n    let d = new Date(DateStr[0], DateStr[1], DateStr[2]);\n    let chekOutD = d.getFullYear() + '-' + ('0' + d.getMonth()).slice(-2) + '-' + ('0' + d.getDate()).slice(-2);\n    return chekOutD;\n  };\n\n  const getPrice = (price, totalDays, persons) => {\n    let ans = price * persons;\n    let rate = ans * totalDays;\n    return rate;\n  };\n\n  const confirmBooking = () => {\n    udpateDetails({ ...bookingDetails,\n      dbooking: false,\n      showPayment: true,\n      totalprice: document.getElementById(\"totalPrice\").innerHTML\n    });\n  };\n\n  const confirmPayment = () => {\n    if (!validateCardNumber() || document.getElementById(\"cardCVV\").length !== 3) {\n      alert(\"Wrong card details!\");\n      return;\n    }\n\n    udpateDetails({ ...bookingDetails,\n      dbooking: false,\n      showPayment: false,\n      bookingMsg: true // type: props.state.hotel.type,\n      // username: JSON.parse(localStorage.getItem(\"signupData\")).name\n\n    }); // Enter the data into the database\n\n    console.log(\"hotel being booked is of type\", bookingDetails);\n    const type = props.state.hotel.type;\n    const id = props.state.hotel.id;\n    const res = bookRoom(bookingDetails, type, id, bedRooms);\n\n    if (res) {\n      alert(\"Room booked succesfully!\");\n    } else {\n      alert(\"Room unavailable\");\n    }\n  };\n\n  function validateCardNumber() {\n    let number = document.getElementById('cardNumber').value;\n    var regex = new RegExp(\"^[0-9]{16}$\");\n    if (!regex.test(number)) return false;\n    return luhnCheck(number);\n  }\n\n  function luhnCheck(val) {\n    var sum = 0;\n\n    for (var i = 0; i < val.length; i++) {\n      var intVal = parseInt(val.substr(i, 1));\n\n      if (i % 2 == 0) {\n        intVal *= 2;\n\n        if (intVal > 9) {\n          intVal = 1 + intVal % 10;\n        }\n      }\n\n      sum += intVal;\n    }\n\n    return sum % 10 == 0;\n  }\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, React.createElement(\"section\", {\n    className: bookingDetails.showBooking ? \"d-block\" : \"d-none\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"input-group input-group-lg mt-5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"input-group-prepend\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"input-group-text\",\n    id: \"inputGroup-sizing-lg\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, \"Check In\")), React.createElement(\"input\", {\n    type: \"date\",\n    min: date,\n    name: \"checkIn\",\n    onChange: handleChange,\n    className: \"form-control\",\n    \"aria-label\": \"Sizing example input\",\n    \"aria-describedby\": \"inputGroup-sizing-lg\",\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"input-group input-group-lg mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"input-group-prepend\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"input-group-text\",\n    id: \"inputGroup-sizing-lg\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, \"Check Out\")), React.createElement(\"input\", {\n    type: \"date\",\n    min: checkOutD(bookingDetails.checkIn),\n    name: \"checkOut\",\n    onChange: handleChange,\n    className: \"form-control\",\n    \"aria-label\": \"Sizing example input\",\n    \"aria-describedby\": \"inputGroup-sizing-lg\",\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"d-flex\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"input-group input-group-lg mt-3 m-1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"input-group-prepend\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"input-group-text\",\n    id: \"inputGroup-sizing-lg\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179\n    },\n    __self: this\n  }, \"Persons\")), React.createElement(\"input\", {\n    type: \"number\",\n    min: \"1\",\n    max: props.state.hotel.maximumAdultsAllow,\n    name: \"adults\",\n    onChange: handleChange,\n    className: \"form-control\",\n    \"aria-label\": \"Sizing example input\",\n    \"aria-describedby\": \"inputGroup-sizing-lg\",\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"input-group input-group-lg mt-3 m-1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"input-group-prepend\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"input-group-text\",\n    id: \"inputGroup-sizing-lg\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }, \"Childs\")), React.createElement(\"input\", {\n    type: \"number\",\n    min: \"0\",\n    max: props.state.hotel.maximumChildsAllow,\n    name: \"childs\",\n    onChange: handleChange,\n    className: \"form-control\",\n    \"aria-label\": \"Sizing example input\",\n    \"aria-describedby\": \"inputGroup-sizing-lg\",\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }))), React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn btn-lg btn-block btn-danger mt-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191\n    },\n    __self: this\n  }, \"Book Now\")))), React.createElement(\"section\", {\n    className: bookingDetails.dbooking ? \"d-block\" : \"d-none\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196\n    },\n    __self: this\n  }, React.createElement(\"table\", {\n    className: \"table table-borderless\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198\n    },\n    __self: this\n  }, React.createElement(\"tbody\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }, \"Check In\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }, bookingDetails.checkIn))), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206\n    },\n    __self: this\n  }, \"Check Out\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  }, bookingDetails.checkOut))), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210\n    },\n    __self: this\n  }, \"No. of Persons\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  }, bookingDetails.adults))), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214\n    },\n    __self: this\n  }, \"No. of Childs\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215\n    },\n    __self: this\n  }, bookingDetails.childs))), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }, \"Total Days\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }, bookingDetails.totalDays))), React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221\n    },\n    __self: this\n  }, React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222\n    },\n    __self: this\n  }, \"Price\"), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    id: \"totalPrice\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223\n    },\n    __self: this\n  }, undefined, getPrice(props.state.hotel.price, bookingDetails.totalDays, bookingDetails.adults)))))), React.createElement(\"button\", {\n    className: \"btn btn-info btn-block rounded\",\n    onClick: confirmBooking,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232\n    },\n    __self: this\n  }, \"Confirm Booking\")), React.createElement(\"section\", {\n    className: bookingDetails.showPayment ? \"d-block\" : \"d-none\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"card text-dark\",\n    style: {\n      width: \"24rem\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"card-header\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row my-0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238\n    },\n    __self: this\n  }, React.createElement(\"h5\", {\n    className: \"mt-1 font-weight-bold\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239\n    },\n    __self: this\n  }, \"Payment Details\"), React.createElement(\"div\", {\n    className: \"display-td\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    className: \"img-responsive pull-right\",\n    src: \"http://i76.imgup.net/accepted_c22e0.png\",\n    alt: \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241\n    },\n    __self: this\n  })))), React.createElement(\"div\", {\n    className: \"card-body\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"cardNumber\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249\n    },\n    __self: this\n  }, \"Card Number\"), React.createElement(\"div\", {\n    className: \"input-group mb-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"text\",\n    className: \"form-control\",\n    id: \"cardNumber\",\n    placeholder: \"Valid card number\",\n    value: \"425465473341333\",\n    \"aria-describedby\": \"basic-addon2\",\n    readOnly: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"input-group-append\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"input-group-text\",\n    id: \"basic-addon2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"fa fa-credit-card\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253\n    },\n    __self: this\n  })))), React.createElement(\"div\", {\n    className: \"form-row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"expireDate\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259\n    },\n    __self: this\n  }, \"Expire Date \"), React.createElement(\"input\", {\n    type: \"text\",\n    id: \"expireDate\",\n    className: \"form-control\",\n    value: \"08/2025\",\n    placeholder: \"MM/YY\",\n    readOnly: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    htmlFor: \"cardCVV\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263\n    },\n    __self: this\n  }, \"CVV\"), React.createElement(\"input\", {\n    type: \"password\",\n    value: \"445\",\n    id: \"cardCVV\",\n    className: \"form-control\",\n    placeholder: \"CVV\",\n    readOnly: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264\n    },\n    __self: this\n  }))), React.createElement(\"label\", {\n    htmlFor: \"AmountPay\",\n    className: \"mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268\n    },\n    __self: this\n  }, \"Amount to Pay\"), React.createElement(\"div\", {\n    className: \"input-group mb-2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col mb-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"text\",\n    value: bookingDetails.totalprice,\n    className: \"form-control\",\n    placeholder: \"Ammout to Pay\",\n    readOnly: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271\n    },\n    __self: this\n  }))), React.createElement(\"button\", {\n    href: \"#\",\n    className: \"btn btn-primary mt-3 btn-block\",\n    onClick: confirmPayment,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276\n    },\n    __self: this\n  }, \"Confirm Payemnt\")))), React.createElement(\"section\", {\n    className: bookingDetails.bookingMsg ? \"d-block\" : \"d-none\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282\n    },\n    __self: this\n  }));\n}","map":{"version":3,"sources":["C:/Users/pc/Desktop/project/oxotel-au3/oxotel/src/components/hotels/Booking.js"],"names":["React","useEffect","useState","Link","bookRoom","Booking","props","console","log","bookingDetails","udpateDetails","checkIn","checkOut","adults","childs","totalDays","totalprice","showBooking","dbooking","showPayment","bookingMsg","username","JSON","parse","localStorage","getItem","bedRooms","state","hotel","handleChange","event","target","value","name","handleSubmit","totaldays","datediff","parseDate","preventDefault","str","mdy","split","Date","first","second","Math","round","today","date","getFullYear","getMonth","slice","getDate","checkOutD","DateStr","Number","d","chekOutD","getPrice","price","persons","ans","rate","confirmBooking","document","getElementById","innerHTML","confirmPayment","validateCardNumber","length","alert","type","id","res","number","regex","RegExp","test","luhnCheck","val","sum","i","intVal","parseInt","substr","maximumAdultsAllow","maximumChildsAllow","undefined","width"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { bookRoom } from '../../api/api';\r\n\r\nexport default function Booking(props) {\r\n\r\n    // const type=props.state.hotel.type\r\n    console.log(\"booking props 1:\",props)\r\n\r\n    const [bookingDetails, udpateDetails] = useState({\r\n        checkIn: \"\",\r\n        checkOut: \"\",\r\n        adults: 0,\r\n        childs: 0,\r\n        totalDays: 0,\r\n        totalprice: 0,\r\n        showBooking: true,\r\n        dbooking: false,\r\n        showPayment: false,\r\n        bookingMsg: false, \r\n        username: \"\",\r\n    })\r\n\r\n    useEffect(() => {\r\n        // const type = props.state.hotel.type\r\n        udpateDetails({\r\n            checkIn: \"\",\r\n            checkOut: \"\",\r\n            adults: 0,\r\n            childs: 0,\r\n            totalDays: 0,\r\n            totalprice: 0,\r\n            showBooking: true,\r\n            dbooking: false,\r\n            showPayment: false,\r\n            bookingMsg: false,\r\n            username: JSON.parse(localStorage.getItem(\"signupData\")).username,\r\n        });\r\n\r\n    },[]);\r\n\r\n    const username = JSON.parse(localStorage.getItem(\"signupData\")).username;\r\n    const bedRooms = props.state.hotel.bedRooms\r\n    console.log(username, bedRooms)\r\n    console.log(\"inside booking props: \", bookingDetails);\r\n    const handleChange = (event) => {\r\n        console.log(event.target.value)\r\n        const { name } = event.target;\r\n        // console.log(e.target.value)\r\n        udpateDetails({\r\n            ...bookingDetails,\r\n            [name]: event.target.value\r\n        });\r\n    };\r\n\r\n    const handleSubmit = (event) => {\r\n        console.log(bookingDetails.checkOut)\r\n        let totaldays = datediff(parseDate(bookingDetails.checkIn), parseDate(bookingDetails.checkOut))\r\n        udpateDetails({\r\n            ...bookingDetails,\r\n            totalDays: totaldays,\r\n            showBooking: false,\r\n            dbooking: true\r\n        });\r\n\r\n        event.preventDefault()\r\n    }\r\n\r\n    const parseDate = (str) => {\r\n        var mdy = str.split('-');\r\n        return new Date(mdy);\r\n    }\r\n\r\n    const datediff = (first, second) => {\r\n        return Math.round((second - first) / (1000 * 60 * 60 * 24));\r\n    }\r\n\r\n\r\n    const today = new Date();\r\n    const date = today.getFullYear() + '-' + ('0' + (today.getMonth() + 1)).slice(-2) + '-' + ('0' + today.getDate()).slice(-2);\r\n\r\n    const checkOutD = (str) => {\r\n        let DateStr = str.split('-')\r\n        DateStr[2] = Number(DateStr[2]) + 1\r\n        let d = new Date(DateStr[0], DateStr[1], DateStr[2])\r\n        let chekOutD = d.getFullYear() + '-' + ('0' + (d.getMonth())).slice(-2) + '-' + ('0' + d.getDate()).slice(-2);\r\n        return chekOutD\r\n    }\r\n\r\n    const getPrice = (price, totalDays, persons) => {\r\n        let ans = price * persons\r\n        let rate = ans * totalDays\r\n        return rate\r\n    }\r\n\r\n    const confirmBooking = () => {\r\n        udpateDetails({\r\n            ...bookingDetails,\r\n            dbooking: false,\r\n            showPayment: true,\r\n            totalprice: document.getElementById(\"totalPrice\").innerHTML\r\n        });\r\n    }\r\n\r\n    const confirmPayment = () => {\r\n        if(!validateCardNumber() || document.getElementById(\"cardCVV\").length !==3){\r\n            alert(\"Wrong card details!\")\r\n            return;\r\n        }\r\n\r\n        udpateDetails({\r\n            ...bookingDetails,\r\n            dbooking: false,\r\n            showPayment: false,\r\n            bookingMsg: true,\r\n            // type: props.state.hotel.type,\r\n            // username: JSON.parse(localStorage.getItem(\"signupData\")).name\r\n        });\r\n\r\n        // Enter the data into the database\r\n\r\n        console.log(\"hotel being booked is of type\", bookingDetails);\r\n        \r\n        const type=props.state.hotel.type\r\n        const id=props.state.hotel.id\r\n        \r\n        const res = bookRoom(bookingDetails, type, id, bedRooms);\r\n        if(res){\r\n            alert(\"Room booked succesfully!\")\r\n        }else {\r\n            alert(\"Room unavailable\")\r\n        }\r\n    }\r\n\r\n    function validateCardNumber() {\r\n        let number = document.getElementById('cardNumber').value;\r\n        var regex = new RegExp(\"^[0-9]{16}$\");\r\n        if (!regex.test(number))\r\n            return false;\r\n    \r\n        return luhnCheck(number);\r\n    }\r\n    \r\n    function luhnCheck(val) {\r\n        var sum = 0;\r\n        for (var i = 0; i < val.length; i++) {\r\n            var intVal = parseInt(val.substr(i, 1));\r\n            if (i % 2 == 0) {\r\n                intVal *= 2;\r\n                if (intVal > 9) {\r\n                    intVal = 1 + (intVal % 10);\r\n                }\r\n            }\r\n            sum += intVal;\r\n        }\r\n        return (sum % 10) == 0;\r\n    }\r\n    \r\n    return (\r\n        <div>\r\n            <section className={bookingDetails.showBooking ? \"d-block\" : \"d-none\"}>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div>\r\n                        <div className=\"input-group input-group-lg mt-5\">\r\n                            <div className=\"input-group-prepend\">\r\n                                <span className=\"input-group-text\" id=\"inputGroup-sizing-lg\">Check In</span>\r\n                            </div>\r\n                            <input type=\"date\" min={date} name=\"checkIn\" onChange={handleChange} className=\"form-control\" aria-label=\"Sizing example input\" aria-describedby=\"inputGroup-sizing-lg\" required />\r\n                        </div>\r\n                        <div className=\"input-group input-group-lg mt-3\">\r\n                            <div className=\"input-group-prepend\">\r\n                                <span className=\"input-group-text\" id=\"inputGroup-sizing-lg\">Check Out</span>\r\n                            </div>\r\n                            <input type=\"date\" min={checkOutD(bookingDetails.checkIn)} name=\"checkOut\" onChange={handleChange} className=\"form-control\" aria-label=\"Sizing example input\" aria-describedby=\"inputGroup-sizing-lg\" required />\r\n                        </div>\r\n                        <div className=\"d-flex\">\r\n                            <div className=\"input-group input-group-lg mt-3 m-1\">\r\n                                <div className=\"input-group-prepend\">\r\n                                    <span className=\"input-group-text\" id=\"inputGroup-sizing-lg\">Persons</span>\r\n                                </div>\r\n                                <input type=\"number\" min=\"1\" max={props.state.hotel.maximumAdultsAllow} name=\"adults\" onChange={handleChange} className=\"form-control\" aria-label=\"Sizing example input\" aria-describedby=\"inputGroup-sizing-lg\" required />\r\n                            </div>\r\n                            <div className=\"input-group input-group-lg mt-3 m-1\">\r\n                                <div className=\"input-group-prepend\">\r\n                                    <span className=\"input-group-text\" id=\"inputGroup-sizing-lg\">Childs</span>\r\n                                </div>\r\n                                <input type=\"number\" min=\"0\" max={props.state.hotel.maximumChildsAllow} name=\"childs\" onChange={handleChange} className=\"form-control\" aria-label=\"Sizing example input\" aria-describedby=\"inputGroup-sizing-lg\" required />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <button type=\"submit\" className=\"btn btn-lg btn-block btn-danger mt-4\">Book Now</button>\r\n\r\n                    </div>\r\n                </form>\r\n            </section>\r\n            <section className={bookingDetails.dbooking ? \"d-block\" : \"d-none\"}>\r\n\r\n                <table className=\"table table-borderless\">\r\n                    <tbody>\r\n\r\n                        <tr>\r\n                            <th>Check In</th>\r\n                            <td><h4>{bookingDetails.checkIn}</h4></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <th>Check Out</th>\r\n                            <td><h4>{bookingDetails.checkOut}</h4></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <th>No. of Persons</th>\r\n                            <td><h4>{bookingDetails.adults}</h4></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <th>No. of Childs</th>\r\n                            <td><h4>{bookingDetails.childs}</h4></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <th>Total Days</th>\r\n                            <td><h4>{bookingDetails.totalDays}</h4></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <th>Price</th>\r\n                            <td><h4 id=\"totalPrice\">\r\n                                {undefined}{getPrice(props.state.hotel.price, bookingDetails.totalDays, bookingDetails.adults)}\r\n                            </h4></td>\r\n                        </tr>\r\n\r\n                    </tbody>\r\n\r\n                </table>\r\n\r\n                <button className=\"btn btn-info btn-block rounded\" onClick={confirmBooking}>Confirm Booking</button>\r\n            </section>\r\n\r\n            <section className={bookingDetails.showPayment ? \"d-block\" : \"d-none\"}>\r\n                <div className=\"card text-dark\" style={{ width: \"24rem\" }} >\r\n                    <div className=\"card-header\">\r\n                        <div className=\"row my-0\">\r\n                            <h5 className=\"mt-1 font-weight-bold\" >Payment Details</h5>\r\n                            <div className=\"display-td\" >\r\n                                <img className=\"img-responsive pull-right\" src=\"http://i76.imgup.net/accepted_c22e0.png\" alt=\"\" />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n\r\n                    <div className=\"card-body\">\r\n\r\n                        <label htmlFor=\"cardNumber\">Card Number</label>\r\n                        <div className=\"input-group mb-3\">\r\n                            <input type=\"text\" className=\"form-control\" id=\"cardNumber\" placeholder=\"Valid card number\" value=\"425465473341333\" aria-describedby=\"basic-addon2\" readOnly />\r\n                            <div className=\"input-group-append\">\r\n                                <span className=\"input-group-text\" id=\"basic-addon2\"><i className=\"fa fa-credit-card\"></i></span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"form-row\">\r\n                            <div className=\"col\">\r\n                                <label htmlFor=\"expireDate\">Expire Date </label>\r\n                                <input type=\"text\" id=\"expireDate\" className=\"form-control\" value=\"08/2025\" placeholder=\"MM/YY\" readOnly />\r\n                            </div>\r\n                            <div className=\"col\">\r\n                                <label htmlFor=\"cardCVV\">CVV</label>\r\n                                <input type=\"password\" value=\"445\" id=\"cardCVV\" className=\"form-control\" placeholder=\"CVV\" readOnly />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <label htmlFor=\"AmountPay\" className=\"mt-3\">Amount to Pay</label>\r\n                        <div className=\"input-group mb-2\">\r\n                            <div className=\"col mb-3\">\r\n                                <input type=\"text\" value={bookingDetails.totalprice} className=\"form-control\" placeholder=\"Ammout to Pay\" readOnly />\r\n                            </div>\r\n                        </div>\r\n\r\n\r\n                        <button href=\"#\" className=\"btn btn-primary mt-3 btn-block\" onClick={confirmPayment}>Confirm Payemnt</button>\r\n                    </div>\r\n                </div>\r\n\r\n            </section>\r\n\r\n            <section className={bookingDetails.bookingMsg ? \"d-block\" : \"d-none\"}>\r\n                {/* <img src=\"https://i.ibb.co/sQrBnc9/b60fb214-e35f-4474-957c-6e63120e66f5-200x200.png\" alt=\"\" /> */}\r\n                {/* <div className=\"alert alert-success\" role=\"alert\">\r\n                    <h4 className=\"alert-heading\">Booking Done!</h4>\r\n                    <h5>{username}</h5>\r\n                    <p>Thank you for your booking and that you have chosen our hotel.</p>\r\n                    <hr />\r\n                    {/* <p className=\"mb-0\">Please note that you can make changes or cancellations of your booking. This request should be solely communicated in writing an Email to buchung@hotel-oxot.de . </p> */}\r\n                    {/* <Link to=\"/home\"><p className=\"alert-link\">Go to Home</p></Link> */}\r\n                {/* </div> */} \r\n            </section >\r\n        </div >\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}